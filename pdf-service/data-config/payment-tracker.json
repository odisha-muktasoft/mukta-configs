{
  "key": "payment-tracker",
  "documentType": "PROJECT-DETAILS",
  "DataConfigs": {
    "moduleName": "rainmaker-expenditure",
    "version": "1.0.0",
    "baseKeyPath": "$.Projects.*",
    "entityIdPath": "$.id",
    "isCommonTableBorderRequired": true,
    "mappings": [
      {
        "topic": "common-pdf-generation-3",
        "mappings": [
          {
            "direct": [
              {
                "variable": "pdf_header",
                "value": {
                  "path": "$.tenantId"
                },
                "localisation": {
                  "required": true,
                  "prefix": "TENANT_TENANTS",
                  "module": "rainmaker-od"
                }
              },
              {
                "variable": "payment_summary",
                "value": {
                  "path": "EXP_PAYMENT_SUMMARY"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "as_on_date",
                "value": {
                  "path": "EXP_AS_ON_DATE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "project_details",
                "value": {
                  "path": "EXP_PROJECT_DETAILS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "projectNumber",
                "value": {
                  "path": "$.projectNumber"
                }
              },
              {
                "variable": "asOnDate",
                "value": {
                  "path": "$.date"
                }
              },
              {
                "variable": "project_name",
                "value": {
                  "path": "PROJECT_NAME_SIMPLE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "project_location",
                "value": {
                  "path": "PROJECT_LOCATION"
                },
                "type": "label",
                "localisation":{
                  "required":true,
                  "prefix": null,
                  "module":"rainmaker-expenditure"
                }
              },
              {
                "variable": "project_description",
                "value": {
                  "path": "PROJECT_DESCRIPTION"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "head_wise_breakup",
                "value": {
                  "path": "HEAD_WISE_BREAKUP"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "estimated_amount",
                "value": {
                  "path": "ESTMATED_AMOUNT"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "wage_amount_paid",
                "value": {
                  "path": "WAGE_AMOUNT_PAID"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "purchase_amount_paid",
                "value": {
                  "path": "PURCHASE_AMOUNT_PAID"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "supervision_amount_paid",
                "value": {
                  "path": "SUPERVISION_AMOUNT_PAID"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "failed_amount_paid",
                "value": {
                  "path": "FAILED_PAYMENT_AMOUNT"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "payment_details",
                "value": {
                  "path": "PAYMENT_DETAILS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "bill_number",
                "value": {
                  "path": "WORKS_BILL_NUMBER"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "bill_amount",
                "value": {
                  "path": "BILL_AMOUNT_RS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "payment_date",
                "value": {
                  "path": "EXP_PAYMENT_DATE"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "payment_status",
                "value": {
                  "path": "PI_STATUS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "payment_failed_rs",
                "value": {
                  "path": "PAYMENT_FAILED_RS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "payment_successful_rs",
                "value": {
                  "path": "PAYMENT_SUCCESSFUL_RS"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "total_sum",
                "value": {
                  "path": "TOTAL"
                },
                "type": "label",
                "localisation": {
                  "required": true,
                  "prefix": null,
                  "module": "rainmaker-expenditure"
                }
              },
              {
                "variable": "name",
                "value": {
                  "path": "$.name"
                }
              },
              {
                "variable": "locality",
                "value": {
                  "path": "$.additionalDetails.locality"
                }
              },
              {
                "variable": "ward",
                "value": {
                  "path": "$.address.boundary"
                }
              },
              {
                "variable": "city",
                "value": {
                  "path": "$.address.city"
                }
              },
              {
                "variable": "description",
                "value": {
                  "path": "$.description"
                }
              },
              {
                "variable": "estimatedAmount",
                "value": {
                  "path": "$.estimatedAmount"
                }
              },
              {
                "variable": "wageAmountPaid",
                "value": {
                  "path": "$.wageAmountPaid"
                }
              },
              {
                "variable": "purchaseAmountPaid",
                "value": {
                  "path": "$.purchaseAmountPaid"
                }
              },
              {
                "variable": "supervisionAmountPaid",
                "value": {
                  "path": "$.supervisionAmountPaid"
                }
              },
              {
                "variable": "failedPaymentAmount",
                "value": {
                  "path": "$.failedPaymentAmount"
                }
              },

              {
                "variable": "tableData",
                "value": {
                  "path": "$.bills"
                },
                "type": "function",
                "format": "var y = [];\nbills = arguments[0];\nvar rupeeFormat = function(amount) {\n    var flag = 0;\n    var count = 0;\n    amount = amount.toString();\n    var len = amount.length;\n    var val = '';\n\n    for (var i = len - 1; i >= 0; i--) {\n        val = amount[i] + val;\n\n        if (amount[i] == '.') {\n            flag = 1;\n            count = -1;\n            val = amount.substring(i, len);\n        }\n\n        if (count % 2 == 0 && i != 0 && count != 0) {\n            val = ',' + val;\n        }\n\n        count += 1;\n    }\n\n    if (flag == 0) {\n        val += '.00';\n    }\n\n    return val;\n};\n\nif (bills.length === 0) {\n    var emptyObject = {\n        billNumber: 'NA',\n        billAmount: 'NA',\n        paymentDate: 'NA',\n        paymentStatus: 'NA',\n        paymentFailed: 'NA',\n        paymentSuccessful: 'NA'\n    };\n    return [emptyObject];\n}\nfor (var i = 0; i < bills.length; i++) {\n    var x = {\n        billNumber: bills[i].businessObject.additionalDetails.billNumber[0],\n        billAmount: rupeeFormat(bills[i].businessObject.grossAmount),\n        paymentDate: bills[i].businessObject.paymentDate,\n        paymentStatus: bills[i].businessObject.piStatus,\n        paymentFailed: rupeeFormat(bills[i].businessObject.failedAmount),\n        paymentSuccessful: rupeeFormat(bills[i].businessObject.successAmount)\n    };\n    y.push(x);\n}\nreturn y;\n"
              },
              {
                "variable": "total",
                "value": {
                  "path": "$.total"
                }
              }
            ]
          },
          {
            "externalAPI": [
              {
                "path": "http://mukta-services.works:8080/mukta-services/mdmsV1/_get/_search",
                "queryParam": "moduleName=tenant&masterName=tenants&tenantId=od&filter=%5B?(@.code=='{$.tenantId}')%5D",
                "apiRequest": null,
                "responseMapping": [
                  {
                    "variable": "address",
                    "value": "$.MdmsRes.tenant.tenants[0].address"
                  },
                  {
                    "variable": "address",
                    "value": "$.MdmsRes.tenant.tenants[0].address"
                  },
                  {
                    "variable": "phoneNumber",
                    "value": "$.MdmsRes.tenant.tenants[0].contactNumber"
                  },
                  {
                    "variable": "website",
                    "value": "$.MdmsRes.tenant.tenants[0].domainUrl"
                  },
                  {
                    "variable": "email",
                    "value": "$.MdmsRes.tenant.tenants[0].emailId"
                  },
                  {
                    "variable": "logoImage",
                    "value": "$.MdmsRes.tenant.tenants[0].logoId",
                    "type": "image"
                  },
                  {
                    "variable": "logo-header",
                    "value": "$.MdmsRes.tenant.tenants[0].code",
                    "localisation": {
                      "required": true,
                      "prefix": "TENANT_TENANTS",
                      "module": "rainmaker-od"
                    }
                  },
                  {
                    "variable": "logo-header",
                    "value": "$.MdmsRes.pdfHeader",
                    "localisation": {
                      "required": true,
                      "prefix": "TENANT_TENANTS",
                      "module": "rainmaker-od"
                    }
                  },
                  {
                    "variable": "subdivision",
                    "value": "$.MdmsRes.tenant.tenants[0].city.ulbGrade",
                    "localisation": {
                      "required": true,
                      "prefix": "COMMON_SUBDIVISION",
                      "module": "rainmaker-common"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}